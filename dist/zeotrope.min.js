/*!
 * zeotrope.js 1.0.0 <>
 * Contributor(s): Kai Lam <kai.chun.lam@gmail.com>
 * Last Build: 2015-08-06
*/


!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){this.el=a,this.ctx=this.el.getContext("2d"),this._resizeHandler=this._onResize.bind(this),window.addEventListener(this._resizeHandler),this._onResize()}var e=a("./helpers"),f=a("./../render/Dimension.js");b.exports=d,d.prototype={dimensions:[],_onResize:function(){var a=this.el.offsetWidth,b=this.el.offsetHeight;if(a!==this.width&&b!==this.height){this.width=a,this.height=b,this.el.setAttribute("width",this.width),this.el.setAttribute("height",this.height);for(var c=0;c<this.dimensions.length;c++)this.dimensions[c].update()}},getDimension:function(a,b){var c=new f(a,b,this);return this.dimensions.push(c),c},detach:function(a){var b;a instanceof f&&(b=this.dimensions),e.remove(b,a)},clear:function(){this.ctx.clearRect(0,0,this.width,this.height)},remove:function(a){window.removeEventListener(this._resizeHandler),a&&this.el.parentElement.removeChild(this.el)}}},{"./../render/Dimension.js":7,"./helpers":5}],2:[function(a,b,c){"use strict";function d(a){var b=this.opt=e.extend({},g,a);this.easing=f[b.easing],this.start=b.start instanceof Date?b.start:new Date,b.delay&&(this.start=new Date(this.start.getTime()+b.delay)),this.end=b.end instanceof Date?b.end:new Date(this.start.getTime()+b.duration),this.duration=this.end.getTime()-this.start}var e=a("./helpers.js"),f=a("./easings.js");b.exports=d;var g={easing:"linear",start:null,end:null,delay:0,duration:1e3,iterate:1};d.prototype={backward:!1,pausedAt:null,getProgress:function(a){var b=this.getCurrent(a);return this.backward&&(b=1-b),0===b||1===b?b:this.easing(b)},getCurrent:function(a){return a=a?a:new Date,null!==this.pausedAt?this.pausedAt:a<this.start?0:a>this.end?1:(a-this.start)/this.duration},pause:function(a){this.pausedAt=this.getCurrent(a)},reverse:function(a){var b=this.getCurrent(a);return this.end=new Date(a.getTime()+b*this.duration),this.start=new Date(this.end.getTime()-this.duration),this.backward=this.backward?!1:!0,this.getCurrent(a)},play:function(a){this.pausedAt&&(a=a?a:new Date,this.end=new Date(a.getTime()+(1-this.pausedAt)*this.duration),this.start=new Date(this.end.getTime()-this.duration),this.pausedAt=null)}}},{"./easings.js":3,"./helpers.js":5}],3:[function(a,b,c){"use strict";b.exports={linear:function(a){return a},easeInQuad:function(a){return a*a},easeOutQuad:function(a){return a*(2-a)},easeInOutQuad:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},easeInCubic:function(a){return a*a*a},easeOutCubic:function(a){return--a*a*a+1},easeInOutCubic:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},easeInQuart:function(a){return a*a*a*a},easeOutQuart:function(a){return 1- --a*a*a*a},easeInOutQuart:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},easeInQuint:function(a){return a*a*a*a*a},easeOutQuint:function(a){return 1+--a*a*a*a*a},easeInOutQuint:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}}},{}],4:[function(a,b,c){"use strict";var d=a("./helpers");b.exports={listeners:[],status:0,_frame:function(){this.status&&(this.execute(),window.requestAnimationFrame(this._frame.bind(this)))},start:function(){this.status=1,window.requestAnimationFrame?this._frame():this._intvl=window.setInterval(this._frame.bind(this),16)},stop:function(){this.status=0,this._intvl&&window.clearInterval(this._intvl)},execute:function(){for(var a=0;a<this.listeners.length;a++)this.listeners[a]()},add:function(a){return this.listeners.length||this.start(),this.listeners.push(a),a},remove:function(a){d.remove(this.listeners,a),this.listeners.length||this.stop()}}},{"./helpers":5}],5:[function(a,b,c){"use strict";b.exports={extend:function(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[0][b]=arguments[a][b]);return arguments[0]},extract:function(a,b){for(var c={},d=0;d<b.length;d++)a[b[d]]&&(c[b[d]]=a[b[d]]);return c},remove:function(a,b){return a.splice(a.indexOf(b),1)}}},{}],6:[function(a,b,c){"use strict";function d(a){this.opt=f.extend({},g,a),this.opt.start&&this.start()}var e=a("./../core/Timeline.js"),f=a("./../core/helpers.js");b.exports=d;var g={fillMode:"both",time:{},start:!0,draw:function(){}};d.prototype={started:!1,start:function(){this.time=new e(this.opt.time),this.draw=this.opt.draw,this.started=!0},render:function(a){this.progress=this.time.getProgress(),this.isFill(this.progress)&&this.draw(a,this.progress)},isFill:function(a){var b=this.opt.fillMode;return"none"!==b||0!==a&&1!==a?"forward"===b&&0===a?!1:"backward"===b&&1===a?!1:!0:!1},detach:function(){this._zeotrope&&this._zeotrope.detach(this)}}},{"./../core/Timeline.js":2,"./../core/helpers.js":5}],7:[function(a,b,c){"use strict";function d(a,b,c){this.opt=j.extend({},k,a),this.baseSize=b,c&&(this.parent=c),this.update()}function e(a){a=a.replace("center","50%"),a=a.replace(/top|left/g,"0"),a=a.replace(/bottom|right/g,"100%");var b=a.split(" ");return[b[0],1===b.length?b[0]:b[1]]}function f(a,b){return-1===a.indexOf("%")?a:a.slice(0,-1)/100*b}function g(a,b,c){return{x:a.x-(c?f(b.x,c.width):b.x),y:a.y-(c?f(b.y,c.height):b.y)}}function h(a,b){var c=a.height/a.width;return{width:"auto"!==b.width&&b.width?b.width:b.height/c,height:"auto"!==b.height&&b.height?b.height:b.width*c}}function i(a,b,c){var d=b.height/b.width,e=c.height/c.width,f="cover"===a?e>d:d>e;return f?{width:c.height/d,height:c.height}:{width:c.width,height:c.width*d}}var j=a("./../core/helpers.js");b.exports=d;var k={position:null,size:null,origin:0};j.extend(d,{parsePropStr:e,percentToPx:f,centerAt:g,fillWithAspectRatio:h,fullScale:i}),d.prototype={update:function(){if(this.opt.size){var a=this.getSize();this.width=a.width,this.height=a.height}if(this.opt.position){var b=this.getPosition();this.x=b.x,this.y=b.y}},getSize:function(){var a;if("auto"===this.opt.size||"auto auto"===this.opt.size)a=j.extract(this.baseSize,["width","height"]);else if("cover"===this.opt.size||"contain"===this.opt.size)a=i(this.opt.size,this.baseSize,this.parent);else{var b=e(this.opt.size);a={width:f(b[0],this.parent?this.parent.width:void 0),height:f(b[1],this.parent?this.parent.height:void 0)},this.baseSize&&(a=h(this.baseSize,a))}return{width:Number(a.width),height:Number(a.height)}},getPosition:function(){var a=e(this.opt.position),b={x:f(a[0],this.parent?this.parent.width:void 0),y:f(a[1],this.parent?this.parent.height:void 0)};if(this.opt.origin){var c=e(this.opt.origin);b=g(b,{x:c[0],y:c[1]},this)}return{x:Number(b.x),y:Number(b.y)}},remove:function(){this.parent&&this.parent.detach(this)}}},{"./../core/helpers.js":5}],8:[function(a,b,c){"use strict";function d(a,b,c){this.opt=e.extend({},f,b),this.el=new Image,this.el.onload=this._onLoad.bind(this),this.el.src=a,this.canvas=c}var e=a("./../core/helpers.js");b.exports=d;var f={size:"cover",position:"center",origin:"50% 50%"};d.prototype={draw:function(a){if(this.loaded){var b=this.dimension;a&&(b=e.extend({},this.dimension,a)),this.canvas.ctx.drawImage(this.el,b.x,b.y,b.width,b.height)}},_onLoad:function(){this.loaded=!0,this.dimension=this.canvas.getDimension(this.opt,this.el),this.onload()},onload:function(){}}},{"./../core/helpers.js":5}],9:[function(a,b,c){"use strict";function d(a,b){this.opt=h.extend({},j,b),this.canvas=new e(a),this.frame=f.add(this.render.bind(this)),this.anims=[],this.imgs=[]}var e=a("./core/Canvas.js"),f=a("./core/frame.js"),g=a("./render/Anim.js"),h=a("./core/helpers.js"),i=a("./render/Img.js");window.Zeotrope=d;var j={onComplete:function(){},destroyOnComplete:!0,removeElOnComplete:!0,onload:function(){},startOnLoad:!0};d.prototype={anim:function(a){this.opt.startOnLoad&&this.imgs.length&&(a.start="boolean"==typeof a.start?a.start:!1);var b=new g(a);return b._zeotrope=this,this.anims.push(b),b},dimension:function(a,b){return this.canvas.getDimension(a,b)},img:function(a,b){var c=new i(a,b,this.canvas);return c.onload=this._onload.bind(this),this.imgs.push(c),c},_onload:function(){for(var a=!0,b=0;b<this.imgs.length;b++)if(!this.imgs[b].loaded){a=!1;break}a&&(this.opt.onload(),this.opt.startOnLoad&&this.startAnims())},startAnims:function(){for(var a=0;a<this.anims.length;a++)this.anims[a].started||this.anims[a].start()},detach:function(a){h.remove(this.anims,a)},render:function(){var a=!0;this.canvas.clear();for(var b=0;b<this.anims.length;b++)this.anims[b].started&&this.anims[b].render(this.canvas),1!==this.anims[b].progress&&(a=!1);a&&(this.opt.onComplete.apply(this),this.opt.destroyOnComplete&&this.remove(this.opt.removeElOnComplete))},remove:function(a){f.remove(this.frame),this.canvas.clear(),this.canvas.remove(a)}}},{"./core/Canvas.js":1,"./core/frame.js":4,"./core/helpers.js":5,"./render/Anim.js":6,"./render/Img.js":8}]},{},[1,2,3,4,5,6,7,8,9]);